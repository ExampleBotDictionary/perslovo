'use strict';

const request = require('request');
const PropSet = require('./PropSet').PropSet;
const HtmlParser = require('./HtmlParser').HtmlParser;

function parseUrl(url, options, next) {
  request(url, (err, res, body) => {
    if (err) { return next(err); }
    if (res.statusCode < 200 || res.statusCode >= 400) {
      return next(null, null);
    }
    const parser = new HtmlParser(options);
    const props = parser.parse(body);
    next(null, props);
  });
}

exports.parseUrl = parseUrl;
exports.HtmlParser = HtmlParser;
exports.PropSet = PropSet;
